<!DOCTYPE html>
<html lang="ko">
<head>
<meta charset="UTF-8">
<title>ì†”ëž­ ë‚´ê¸° ì†¡ì¶œ í™”ë©´</title>
<link href="https://fonts.googleapis.com/css2?family=Orbitron:wght@700&display=swap" rel="stylesheet">
<style>
  body { background:#111; color:#fff; font-family:'Orbitron', sans-serif; padding:20px; }
  h1 { text-align:center; font-size:3em; color:#0ff; text-shadow: 0 0 10px #0ff,0 0 20px #0ff; margin-bottom:20px;}
  #screen { display:flex; flex-wrap: wrap; gap:10px; justify-content:center; }
  .player-card {
    padding:10px 15px;
    border-radius:10px;
    background:#222;
    color:#fff;
    text-shadow:0 0 5px #0ff;
    font-weight:bold;
    transition: all 0.3s ease;
  }
  .win { text-shadow: 0 0 10px lime,0 0 20px lime; animation: glow 1s infinite alternate; }
  .lose { text-shadow: 0 0 10px red,0 0 20px darkred; opacity:0.6; }
  .emoji { margin-left:5px; }
  @keyframes glow {
    0% { text-shadow: 0 0 5px lime,0 0 10px lime; }
    100% { text-shadow: 0 0 20px lime,0 0 40px lime; }
  }
</style>
</head>
<body>

<h1 id="title">5 VS 5 ì†”ëž­ ë‚´ê¸°</h1>
<div id="screen"></div>

<script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js"></script>
<script>
const supabaseUrl = 'https://hsvknfmnsehwytnvaiwr.supabase.co';
const supabaseKey = 'sb_publishable_l2wj1IeGSfcxgKVjJ28n0w_WK9iHm-j';
const supabaseClient = supabase.createClient(supabaseUrl, supabaseKey);

function updateScreen(players){
  const screenDiv = document.getElementById('screen');
  screenDiv.innerHTML = '';

  const ourTeam = players.filter(p => p.team==='ìš°ë¦¬íŒ€');
  const oppTeam = players.filter(p => p.team==='ìƒëŒ€íŒ€');

  // ì œëª© ìžë™ ë³€ê²½
  document.getElementById('title').textContent = `${ourTeam.length} VS ${oppTeam.length} ì†”ëž­ ë‚´ê¸°`;

  players.forEach(p => {
    const div = document.createElement('div');
    div.className = 'player-card';
    let streakEmoji = '';
    if(p.streak > 1) { div.classList.add('win'); streakEmoji='ðŸ”¥'; }
    else if(p.streak < -1) { div.classList.add('lose'); streakEmoji='ðŸ’€'; }

    div.innerHTML = `${p.name} (${p.team}) ${p.wins}ìŠ¹ ${p.losses}íŒ¨ ${streakEmoji ? `<span class="emoji">${streakEmoji}</span>`:''}`;
    screenDiv.appendChild(div);
  });
}

async function loadPlayers(){
  const { data: players, error } = await supabaseClient.from('players').select('*');
  if(error) console.log('DB ë¶ˆëŸ¬ì˜¤ê¸° ì˜¤ë¥˜:', error);
  else updateScreen(players);
}

// v2 ì‹¤ì‹œê°„ êµ¬ë…
supabaseClient
  .channel('players_channel')
  .on(
    'postgres_changes', 
    { event: '*', schema: 'public', table: 'players' }, 
    payload => { loadPlayers(); }
  )
  .subscribe();

loadPlayers();
</script>
</body>
</html>












