<!DOCTYPE html>
<html lang="ko">
<head>
<meta charset="UTF-8">
<title>ì†”ë­ ë‚´ê¸° ì†¡ì¶œ íŒ¨ë„</title>
<link href="https://fonts.googleapis.com/css2?family=Pretendard:wght@600;800&family=Orbitron:wght@600;800&display=swap" rel="stylesheet">
<script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
<style>
body{margin:0;background:#000;color:#fff;font-family:'Pretendard',sans-serif;display:flex;justify-content:center;align-items:flex-start;height:100vh;}
.container{display:flex;justify-content:center;align-items:flex-start;gap:60px;}
.team{display:flex;flex-direction:column;align-items:center;}
.red h1{color:#ff5c5c;}
.blue h1{color:#4db8ff;}
.team h1{text-align:center;font-size:36px;margin-bottom:10px;letter-spacing:2px;font-family:'Orbitron',sans-serif;}
.summary{text-align:center;font-size:18px;margin-bottom:10px;animation:scoreGlow 1.4s infinite;}
@keyframes scoreGlow{0%,100%{text-shadow:0 0 4px #fff;opacity:0.7;}50%{text-shadow:0 0 12px #fff;opacity:1;}}
.members{display:flex;flex-direction:column;align-items:center;gap:8px;}
.member-card{background:rgba(255,255,255,0.05);border:2px solid rgba(255,255,255,0.2);border-radius:12px;padding:12px 18px;width:180px;min-height:160px;text-align:center;font-size:14px;position:relative;transition:transform 0.3s;}
.member-card:hover{transform:scale(1.05);}
.name{font-weight:800;margin-bottom:6px;font-family:'Orbitron',sans-serif;font-size:16px;}
.record{display:flex;justify-content:center;gap:6px;font-weight:600;font-size:16px;margin-bottom:4px;}
.win{color:#ffd369;}
.lose{color:#ff6b6b;}
.recent{display:flex;justify-content:center;gap:4px;margin-top:4px;}
.recent-dot{width:14px;height:14px;border-radius:50%;display:inline-block;}
.recent-dot.win{background:#ffd369;}
.recent-dot.lose{background:#ff6b6b;}
.recent-dot.empty{background:#555;}
.champions{display:flex;justify-content:center;flex-wrap:wrap;gap:2px;margin-top:4px;}
.champions img{width:24px;height:24px;border-radius:4px;}
.streak{margin-left:5px;font-size:14px;font-weight:700;}
</style>
</head>
<body>

<div class="container">
  <div class="team red">
    <h1 id="redName">RED TEAM</h1>
    <div class="summary" id="redSummary"></div>
    <div class="members" id="redPlayers"></div>
  </div>
  <div class="team blue">
    <h1 id="blueName">BLUE TEAM</h1>
    <div class="summary" id="blueSummary"></div>
    <div class="members" id="bluePlayers"></div>
  </div>
</div>

<script>
const SUPABASE_URL = "https://hsvknfmnsehwytnvaiwr.supabase.co";
const SUPABASE_KEY = "sb_publishable_l2wj1IeGSfcxgKVjJ28n0w_WK9iHm-j";
const sb = supabase.createClient(SUPABASE_URL, SUPABASE_KEY);

// íŒ€ ì¹´ë“œ ë Œë”
async function render() {
  const { data: players } = await sb.from('players').select('*');
  const { data: setting } = await sb.from('settings').select('*').single();

  document.getElementById('redName').textContent = setting.red_team_name;
  document.getElementById('blueName').textContent = setting.blue_team_name;

  renderTeam(players.filter(p=>p.team==='red'), 'redPlayers', 'redSummary');
  renderTeam(players.filter(p=>p.team==='blue'), 'bluePlayers', 'blueSummary');
}

function renderTeam(list, containerId, summaryId){
  const container = document.getElementById(containerId);
  container.innerHTML = '';
  let w=0, l=0;

  list.forEach(p=>{
    w+=p.wins; l+=p.losses;

    // ì—°ìŠ¹/ì—°íŒ¨
    let streakText='', streakClass='';
    if(p.streak>0){streakText=`â­${p.streak}ì—°ìŠ¹`; streakClass=`streak win`;}
    else if(p.streak<0){streakText=`ğŸ’€${Math.abs(p.streak)}ì—°íŒ¨`; streakClass=`streak lose`; }

    // ìµœê·¼ 10ì „
    const recentArr = (p.recent || []).slice(-10);
    let recentHTML = recentArr.map(r=>{
      if(r==='win') return '<span class="recent-dot win"></span>';
      if(r==='lose') return '<span class="recent-dot lose"></span>';
      return '<span class="recent-dot empty"></span>';
    }).join('');
    while(recentHTML.split('<span').length-1 < 10) recentHTML += '<span class="recent-dot empty"></span>';

    // ì±”í”¼ì–¸ ì•„ì´ì½˜
    const champHTML = (p.champions || []).map(c=>{
      return `<img src="https://ddragon.leagueoflegends.com/cdn/16.3.1/img/champion/${c}.png" alt="${c}">`;
    }).join('');

    container.insertAdjacentHTML('beforeend', `
      <div class="member-card">
        <div class="name">${p.name} ${streakText ? `<span class="${streakClass}">${streakText}</span>` : ''}</div>
        <div class="record"><span class="win">ğŸ˜ ${p.wins}ìŠ¹</span> / <span class="lose">ğŸ˜¡ ${p.losses}íŒ¨</span></div>
        <div class="recent">${recentHTML}</div>
        <div class="champions">${champHTML}</div>
      </div>
    `);
  });

  const summaryEl = document.getElementById(summaryId);
  summaryEl.innerHTML = `<span class="win">ğŸ˜ ${w}ìŠ¹</span> / <span class="lose">ğŸ˜¡ ${l}íŒ¨</span>`;
}

// ì‹¤ì‹œê°„ ë°˜ì˜
render();
sb.channel('realtime')
  .on('postgres_changes',{event:'*',schema:'public',table:'players'},render)
  .on('postgres_changes',{event:'*',schema:'public',table:'settings'},render)
  .subscribe();
</script>
</body>
</html>













































