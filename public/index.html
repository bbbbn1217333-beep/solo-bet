<!DOCTYPE html>
<html lang="ko">
<head>
<meta charset="UTF-8">
<title>Ïù¥ÎùºÎÑ§ ÏÜîÎû≠ ÎÇ¥Í∏∞ ÏÜ°Ï∂úÏö©</title>
<link href="https://fonts.googleapis.com/css2?family=Pretendard:wght@600;800&family=Orbitron:wght@600;800&display=swap" rel="stylesheet">
<script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
<style>
    /* Í∏∞Ï°¥ Ïä§ÌÉÄÏùº Ïú†ÏßÄ + ing Ïä§ÌÉÄÏùº Ï∂îÍ∞Ä */
    body{margin:0; background:#000; color:#fff; font-family:'Pretendard',sans-serif; overflow:hidden;}
    .scene{position:absolute; inset:0; opacity:0; transition:opacity .6s ease; display:none;}
    .scene.active{opacity:1; z-index:1; display:block;}
    .container{display:flex; gap:60px; justify-content:center; margin-top:20px;}
    .team{display:flex; flex-direction:column; align-items:center;}
    .team h1{font-family:'Orbitron',sans-serif; font-size:50px; margin-bottom:4px;}
    .red h1{color:#ff5c5c} .blue h1{color:#4db8ff;}
    .summary{font-size:26px; font-weight:800; margin-bottom:12px;}
    .summary .win{color:#ffd369; text-shadow:0 0 12px #ffd369;}
    .summary .lose{color:#ff6b6b; text-shadow:0 0 12px #ff6b6b;}
    .member-card{position:relative; width:260px; padding:18px 10px 12px; background:rgba(255,255,255,.06); border-radius:14px; border:2px solid rgba(120,120,120,.35); text-align:center; margin-bottom:10px;}
    .history{display:flex; justify-content:center; gap:6px; margin-top:10px;}
    .champ{position:relative; width:22px; height:22px;}
    .champ img{width:100%; height:100%; border-radius:4px; border: 1px solid rgba(255,255,255,0.2);}
    .wl-badge { position: absolute; top: -9px; left: 50%; transform: translateX(-50%); width: 15px; height: 15px; background: #000; border: 1px solid rgba(255,255,255,0.3); border-radius: 3px; font-size: 9px; font-weight: 900; display: flex; align-items: center; justify-content: center; }
    .wl-badge.win { color: #ffd369; border-color: #ffd369; }
    .wl-badge.lose { color: #ff4d4d; border-color: #ff4d4d; }
    .wl-badge.ing { color: #777; border-color: #444; } /* ÏßÑÌñâÏ§ë Î±ÉÏßÄ */
    .name{font-family:'Orbitron',sans-serif; font-size:18px; font-weight:800;}
    .record{font-size:15px; font-weight:800; margin-bottom:8px;}
    .record .win{color:#ffd369;} .record .lose{color:#ff6b6b;}
    .score-board{margin-top:180px; text-align:center; font-family:'Orbitron',sans-serif;}
    .score-wrap{display:flex; justify-content:center; gap:140px;}
    .score{font-size:130px; text-shadow:0 0 18px #fff;}
    .score.win { animation: glow 1.2s infinite alternate; }
    @keyframes glow { from { transform: scale(1); } to { transform: scale(1.1); } }
</style>
</head>
<body>
<div class="scene active" id="scene-all"></div>
<div class="scene" id="scene-red"></div>
<div class="scene" id="scene-blue"></div>
<div class="scene" id="scene-score"></div>

<script>
const SUPABASE_URL = "https://hsvknfmnsehwytnvaiwr.supabase.co";
const SUPABASE_KEY = "sb_publishable_l2wj1IeGSfcxgKVjJ28n0w_WK9iHm-j";
const sb = supabase.createClient(SUPABASE_URL, SUPABASE_KEY);

let players = [], settings = { red_team_name: 'RED', blue_team_name: 'BLUE' };

async function loadData() {
    const { data: sData } = await sb.from('settings').select('*').single();
    const { data: pData } = await sb.from('players').select('*');
    if(sData) settings = sData;
    if(pData) {
        players = pData.map(p => {
            let streak = 0;
            const valid = p.recent.filter(r => r !== 'ing'); // ÏßÑÌñâÏ§ë Ï†úÏô∏ÌïòÍ≥† Í≥ÑÏÇ∞
            const last = valid[0];
            for(let r of valid) { if(r === last) streak++; else break; }
            return { ...p, streak: last === 'win' ? streak : -streak };
        });
    }
    renderAll();
}

function renderAll() {
    renderScene(document.getElementById('scene-all'));
    renderScene(document.getElementById('scene-red'), 'red');
    renderScene(document.getElementById('scene-blue'), 'blue');
    renderScore();
}

function renderScene(container, team = null) {
    const list = team ? players.filter(p => p.team === team) : players;
    container.innerHTML = `<div class="container">${['red','blue'].map(t => {
        if(team && team !== t) return '';
        const arr = players.filter(p => p.team === t);
        const win = arr.reduce((a, b) => a + b.wins, 0);
        const lose = arr.reduce((a, b) => a + b.losses, 0);
        return `<div class="team ${t}">
            <h1>${(t === 'red' ? settings.red_team_name : settings.blue_team_name).toUpperCase()}</h1>
            <div class="summary"><span class="win">üòÅ ${win}Ïäπ</span> / <span class="lose">üò° ${lose}Ìå®</span></div>
            <div class="members">${arr.map(p => `
                <div class="member-card">
                    <div class="name">${p.name}</div>
                    <div class="record"><span class="win">üòÅ ${p.wins}Ïäπ</span> / <span class="lose">üò° ${p.losses}Ìå®</span></div>
                    <div class="history">${p.recent.map((r, i) => `
                        <div class="champ">
                            <img src="https://ddragon.leagueoflegends.com/cdn/14.3.1/img/champion/${p.champions[i]}.png" onerror="this.src='https://ddragon.leagueoflegends.com/cdn/14.3.1/img/profileicon/29.png'">
                            <span class="wl-badge ${r}">${r === 'win' ? 'W' : r === 'lose' ? 'L' : '...'}</span>
                        </div>`).join('')}</div>
                </div>`).join('')}</div>
        </div>`;
    }).join('')}</div>`;
}

function renderScore() {
    const rW = players.filter(p=>p.team==='red').reduce((a,b)=>a+b.wins,0);
    const bW = players.filter(p=>p.team==='blue').reduce((a,b)=>a+b.wins,0);
    document.getElementById('scene-score').innerHTML = `
        <div class="score-board">
            <div class="score-wrap">
                <div class="score ${rW>bW?'win':''}">${rW}</div>
                <div style="font-size:50px">VS</div>
                <div class="score ${bW>rW?'win':''}">${bW}</div>
            </div>
        </div>`;
}

sb.channel('db-changes').on('postgres_changes',{event:'*',schema:'public',table:'settings'},loadData)
.on('postgres_changes',{event:'*',schema:'public',table:'players'},loadData).subscribe();

let idx = 0;
setInterval(() => {
    const scenes = document.querySelectorAll('.scene');
    scenes[idx].classList.remove('active');
    idx = (idx + 1) % 4;
    scenes[idx].classList.add('active');
}, 8000);

loadData();
</script>
</body>
</html>















































