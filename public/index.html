<!DOCTYPE html>
<html lang="ko">
<head>
<meta charset="UTF-8">
<title>솔랭 내기 송출 패널</title>

<link href="https://fonts.googleapis.com/css2?family=Pretendard:wght@600;800&family=Orbitron:wght@600;800&display=swap" rel="stylesheet">
<script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>

<style>
body {
  margin:0;
  background:radial-gradient(circle at top,#1a1a1a,#050505);
  color:#fff;
  font-family:'Pretendard', sans-serif;
}

.container {
  display:flex;
  height:100vh;
}

/* 팀 영역 */
.team {
  flex:1;
  padding:30px;
}

.red {
  background:linear-gradient(180deg,#3a0000,#070707);
}
.blue {
  background:linear-gradient(180deg,#001f3a,#070707);
}

/* 팀명 */
.team h1 {
  text-align:center;
  font-size:42px;
  margin-bottom:8px;
  letter-spacing:2px;
  font-family:'Orbitron', sans-serif;
}

.red h1 {
  color:#ff5c5c;
  text-shadow:0 0 25px #ff5c5c;
}
.blue h1 {
  color:#4db8ff;
  text-shadow:0 0 25px #4db8ff;
}

/* 요약 */
.summary {
  text-align:center;
  font-size:20px;
  margin-bottom:18px;
}

/* 테이블 */
table {
  width:100%;
  border-collapse:collapse;
}

th {
  padding:14px 0;
  font-size:22px;
  border-bottom:2px solid #333;
}

/* 헤더 색상 */
.red-table .th-name {
  color:#ff7a7a;
  text-shadow:0 0 14px #ffb3b3;
}
.blue-table .th-name {
  color:#6cc7ff;
  text-shadow:0 0 14px #b8e4ff;
}

.th-win {
  color:#ffd369;
  text-shadow:0 0 18px #fff1b0;
  animation:sparkle 1.6s infinite;
}
.th-lose {
  color:#ff5c5c;
  text-shadow:0 0 18px #ff9a9a;
  animation:sparkle 1.6s infinite;
}

/* 셀 */
td {
  padding:10px 0;
  text-align:center;
  font-size:20px;
}

.name-red {
  color:#ff9a9a;
}
.name-blue {
  color:#9ad4ff;
}

.win {
  color:#ffd369;
  text-shadow:0 0 10px #fff1b0;
  font-family:'Orbitron', sans-serif;
}
.lose {
  color:#ff6b6b;
  text-shadow:0 0 10px #ff9a9a;
  font-family:'Orbitron', sans-serif;
}

tr:nth-child(even) {
  background:rgba(255,255,255,0.03);
}

/* 반짝 애니메이션 */
@keyframes sparkle {
  0% { opacity:0.7; }
  50% { opacity:1; }
  100% { opacity:0.7; }
}
</style>
</head>

<body>
<div class="container">

  <!-- RED -->
  <div class="team red">
    <h1 id="redName">RED TEAM</h1>
    <div class="summary" id="redSummary"></div>
    <table class="red-table">
      <thead>
        <tr>
          <th class="th-name">스트리머</th>
          <th class="th-win">승리</th>
          <th class="th-lose">패배</th>
        </tr>
      </thead>
      <tbody id="redPlayers"></tbody>
    </table>
  </div>

  <!-- BLUE -->
  <div class="team blue">
    <h1 id="blueName">BLUE TEAM</h1>
    <div class="summary" id="blueSummary"></div>
    <table class="blue-table">
      <thead>
        <tr>
          <th class="th-name">스트리머</th>
          <th class="th-win">승리</th>
          <th class="th-lose">패배</th>
        </tr>
      </thead>
      <tbody id="bluePlayers"></tbody>
    </table>
  </div>

</div>

<script>
const SUPABASE_URL = "https://hsvknfmnsehwytnvaiwr.supabase.co";
const SUPABASE_KEY = "sb_publishable_l2wj1IeGSfcxgKVjJ28n0w_WK9iHm-j";
const sb = supabase.createClient(SUPABASE_URL, SUPABASE_KEY);

async function render() {
  const { data: players } = await sb.from('players').select('*');
  const { data: setting } = await sb.from('settings').select('*').single();

  document.getElementById('redName').textContent = setting.red_team_name;
  document.getElementById('blueName').textContent = setting.blue_team_name;

  const red = players.filter(p=>p.team==='red');
  const blue = players.filter(p=>p.team==='blue');

  renderTeam(red,'redPlayers','redSummary','red');
  renderTeam(blue,'bluePlayers','blueSummary','blue');
}

function renderTeam(list, bodyId, summaryId, team) {
  const body = document.getElementById(bodyId);
  body.innerHTML = '';

  let w=0,l=0;

  list.forEach(p=>{
    w+=p.wins;
    l+=p.losses;

    body.insertAdjacentHTML('beforeend',`
      <tr>
        <td class="name-${team}">${p.name}</td>
        <td class="win">${p.wins}</td>
        <td class="lose">${p.losses}</td>
      </tr>
    `);
  });

  document.getElementById(summaryId).innerHTML =
    `<span class="win">${w}승</span> / <span class="lose">${l}패</span>`;
}

/* 최초 렌더 */
render();

/* 실시간 반영 */
sb.channel('realtime')
  .on('postgres_changes',{event:'*',schema:'public',table:'players'},render)
  .on('postgres_changes',{event:'*',schema:'public',table:'settings'},render)
  .subscribe();
</script>

</body>
</html>




















