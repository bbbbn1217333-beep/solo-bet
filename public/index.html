<!DOCTYPE html>
<html lang="ko">
<head>
<meta charset="UTF-8">
<title>ì†”ë­ ë‚´ê¸° ì†¡ì¶œ</title>

<link href="https://fonts.googleapis.com/css2?family=Orbitron:wght@600;800&display=swap" rel="stylesheet">

<style>
body {
  margin:0;
  background:#0b0b0b;
  color:#fff;
  font-family:'Orbitron', sans-serif;
  overflow:hidden;
}

.container {
  display:flex;
  height:100vh;
}

/* ===== íŒ€ ì˜ì—­ ===== */
.team {
  flex:1;
  padding:20px;
}

.red {
  background:linear-gradient(180deg,#2a0000,#0b0b0b);
}
.blue {
  background:linear-gradient(180deg,#001a2a,#0b0b0b);
}

.team h1 {
  text-align:center;
  font-size:32px;
  margin-bottom:10px;
}

.red h1 {
  color:#ff4444;
  text-shadow:0 0 15px #ff4444;
}
.blue h1 {
  color:#44aaff;
  text-shadow:0 0 15px #44aaff;
}

/* ===== ìš”ì•½ ===== */
.summary {
  text-align:center;
  font-size:18px;
  margin-bottom:15px;
  min-height:48px;
}

/* ===== ì—°ìŠ¹ / ì—°íŒ¨ ì´í™íŠ¸ ===== */
.streak-win {
  animation: winGlow 1.2s infinite;
  color:#00ff99;
}

@keyframes winGlow {
  0% {
    text-shadow:0 0 6px #00ff99;
    transform:scale(1);
  }
  50% {
    text-shadow:0 0 25px #00ff99, 0 0 50px #00ffaa;
    transform:scale(1.1);
  }
  100% {
    text-shadow:0 0 6px #00ff99;
    transform:scale(1);
  }
}

.streak-lose {
  animation: loseShake 0.4s infinite;
  color:#ff5555;
  opacity:0.75;
}

@keyframes loseShake {
  0% { transform:translateX(0); }
  25% { transform:translateX(-2px); }
  50% { transform:translateX(2px); }
  75% { transform:translateX(-2px); }
  100% { transform:translateX(0); }
}

/* ===== í…Œì´ë¸” ===== */
table {
  width:100%;
  border-collapse:collapse;
  font-size:15px;
}

th, td {
  padding:7px;
  text-align:center;
}

th {
  border-bottom:2px solid #444;
  color:#aaa;
}

tr:nth-child(even) {
  background:#111;
}

.win {
  color:#00ff99;
}
.lose {
  color:#ff5555;
}
</style>
</head>

<body>

<div class="container">

  <!-- RED TEAM -->
  <div class="team red">
    <h1 id="redName">RED TEAM</h1>
    <div class="summary" id="redSummary"></div>

    <table>
      <thead>
        <tr>
          <th>ë‹‰ë„¤ì„</th>
          <th>ìŠ¹</th>
          <th>íŒ¨</th>
        </tr>
      </thead>
      <tbody id="redPlayers"></tbody>
    </table>
  </div>

  <!-- BLUE TEAM -->
  <div class="team blue">
    <h1 id="blueName">BLUE TEAM</h1>
    <div class="summary" id="blueSummary"></div>

    <table>
      <thead>
        <tr>
          <th>ë‹‰ë„¤ì„</th>
          <th>ìŠ¹</th>
          <th>íŒ¨</th>
        </tr>
      </thead>
      <tbody id="bluePlayers"></tbody>
    </table>
  </div>

</div>

<script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
<script>
/* ===== Supabase ì„¤ì • ===== */
const SUPABASE_URL = "https://hsvknfmnsehwytnvaiwr.supabase.co";
const SUPABASE_KEY = "sb_publishable_l2wj1IeGSfcxgKVjJ28n0w_WK9iHm-j";

const sb = supabase.createClient(SUPABASE_URL, SUPABASE_KEY);

/* ===== DOM ===== */
const redName = document.getElementById('redName');
const blueName = document.getElementById('blueName');

/* ===== SETTINGS ===== */
async function loadSettings() {
  const { data } = await sb
    .from('settings')
    .select('*')
    .single();

  if (!data) return;

  redName.textContent = data.red_team_name || 'RED TEAM';
  blueName.textContent = data.blue_team_name || 'BLUE TEAM';
}

/* ===== PLAYERS ===== */
async function loadPlayers() {
  const { data: players } = await sb
    .from('players')
    .select('*')
    .order('id');

  if (!players) return;

  const red = players.filter(p => p.team === 'red');
  const blue = players.filter(p => p.team === 'blue');

  renderTeam(red, 'redPlayers', 'redSummary');
  renderTeam(blue, 'bluePlayers', 'blueSummary');
}

function renderTeam(list, bodyId, summaryId) {
  const body = document.getElementById(bodyId);
  const summary = document.getElementById(summaryId);

  body.innerHTML = '';

  let win = 0;
  let lose = 0;
  let streak = 0;

  list.forEach(p => {
    win += p.wins;
    lose += p.losses;
    streak += p.streak;

    body.insertAdjacentHTML('beforeend', `
      <tr>
        <td>${p.name}</td>
        <td class="win">${p.wins}</td>
        <td class="lose">${p.losses}</td>
      </tr>
    `);
  });

  let streakText = '';
  summary.className = 'summary';

  if (streak > 0) {
    streakText = `ğŸ”¥ ${streak} ì—°ìŠ¹`;
    summary.classList.add('streak-win');
  } else if (streak < 0) {
    streakText = `ğŸ’€ ${Math.abs(streak)} ì—°íŒ¨`;
    summary.classList.add('streak-lose');
  }

  summary.innerHTML = `
    ${win}ìŠ¹ ${lose}íŒ¨<br>
    ${streakText}
  `;
}

/* ===== ìµœì´ˆ ë¡œë“œ ===== */
loadSettings();
loadPlayers();

/* ===== OBS ìƒˆë¡œê³ ì¹¨ ì—†ëŠ” ì‹¤ì‹œê°„ ===== */
sb.channel('realtime')
  .on(
    'postgres_changes',
    { event:'*', schema:'public', table:'settings' },
    loadSettings
  )
  .on(
    'postgres_changes',
    { event:'*', schema:'public', table:'players' },
    loadPlayers
  )
  .subscribe();
</script>

</body>
</html>















