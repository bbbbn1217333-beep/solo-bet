<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8">
  <title>5 VS 5 솔랭 내기</title>
  <style>
    body { font-family: 'Segoe UI', sans-serif; padding:20px; background:#f0f0f0; }
    h1 { text-align:center; margin-bottom:20px; }
    #screen div { margin:5px 0; font-size:18px; }
    .win { color:green; }
    .lose { color:red; }
  </style>
</head>
<body>

<h1>5 VS 5 솔랭 내기</h1>
<div id="screen"></div>

<script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js"></script>
<script>
const supabaseUrl = 'https://hsvknfmnsehwytnvaiwr.supabase.co';
const supabaseKey = 'sb_publishable_l2wj1IeGSfcxgKVjJ28n0w_WK9iHm-j';
const supabaseClient = supabase.createClient(supabaseUrl, supabaseKey);

function updateScreen(players){
  const screenDiv = document.getElementById('screen');
  screenDiv.innerHTML = '';
  players.forEach(p => {
    const div = document.createElement('div');
    const streakText = p.streak>1 ? `${p.streak}연승` : '';
    div.innerHTML = `<span>${p.name} (${p.team}) - ${p.wins}승 ${p.losses}패 ${streakText}</span>`;
    if(p.streak>0) div.classList.add('win');
    screenDiv.appendChild(div);
  });
}

async function loadPlayers(){
  const { data: players, error } = await supabaseClient.from('players').select('*');
  if(error) console.log('DB 불러오기 오류:', error);
  else updateScreen(players);
}

// Supabase v2 실시간 구독
supabaseClient
  .channel('players_channel')
  .on(
    'postgres_changes', 
    { event: '*', schema: 'public', table: 'players' }, 
    (payload) => {
      loadPlayers();
    }
  )
  .subscribe();

// 초기 로드
loadPlayers();
</script>
</body>
</html>











