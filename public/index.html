<!DOCTYPE html>
<html lang="ko">
<head>
<meta charset="UTF-8">
<title>ì†”ë­ ë‚´ê¸° ì†¡ì¶œ íŒ¨ë„</title>

<link href="https://fonts.googleapis.com/css2?family=Pretendard:wght@600;800&family=Orbitron:wght@600;800&display=swap" rel="stylesheet">
<script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>

<style>
body {
  margin:0;
  background:#000;
  color:#fff;
  font-family:'Pretendard', sans-serif;
}

.container {
  display:flex;
  height:100vh;
  justify-content:space-around;
  align-items:center;
}

/* íŒ€ ì˜ì—­ */
.team {
  flex:1;
  padding:10px 20px;
  display:flex;
  flex-direction:column;
  align-items:center;
  overflow-y:auto;
}

.red {
  background:linear-gradient(180deg,#140000,#000);
}
.blue {
  background:linear-gradient(180deg,#000814,#000);
}

/* íŒ€ëª… */
.team h1 {
  text-align:center;
  font-size:32px;
  margin-bottom:10px;
  letter-spacing:2px;
  font-family:'Orbitron', sans-serif;
}

.red h1 { color:#ff5c5c; }
.blue h1 { color:#4db8ff; }

/* ìš”ì•½ */
.summary {
  text-align:center;
  font-size:18px;
  margin-bottom:10px;
  animation:scoreGlow 1.4s infinite;
}

@keyframes scoreGlow {
  0%   { text-shadow:0 0 4px #fff; opacity:0.7; }
  50%  { text-shadow:0 0 12px #fff; opacity:1; }
  100% { text-shadow:0 0 4px #fff; opacity:0.7; }
}

/* ë©¤ë²„ ì¹´ë“œ (ì„¸ë¡œ ë°°ì—´) */
.members {
  display:flex;
  flex-direction:column;
  align-items:center;
  gap:8px;
}

.member-card {
  background:rgba(255,255,255,0.05);
  border:2px solid rgba(255,255,255,0.2);
  border-radius:12px;
  padding:12px 18px;
  width:180px;
  text-align:center;
  font-size:14px;
  position:relative;
  transition: transform 0.3s;
}

.member-card:hover {
  transform:scale(1.05);
}

/* ì´ë¦„ + ìƒëŒ€íŒ€ */
.member-card .name {
  font-weight:800;
  margin-bottom:4px;
  font-family:'Orbitron', sans-serif;
}

.member-card .vs {
  font-size:12px;
  color:#aaa;
}

/* ìŠ¹íŒ¨ */
.member-card .record {
  display:flex;
  justify-content:center;
  gap:6px;
  font-weight:600;
  font-size:14px;
}

.win { color:#ffd369; }
.lose { color:#ff6b6b; }

/* ì—°ìŠ¹/ì—°íŒ¨ */
.streak {
  margin-top:4px;
  font-size:14px;
  font-weight:700;
  display:flex;
  justify-content:center;
}

.streak span {
  margin-left:5px;
}

/* í…Œë‘ë¦¬ ë°˜ì§ì„ */
@keyframes borderGlowYellow {
  0%,100% { box-shadow:0 0 6px #fff; }
  50% { box-shadow:0 0 12px #ffeb3b; }
}
@keyframes borderGlowRed {
  0%,100% { box-shadow:0 0 6px #fff; }
  50% { box-shadow:0 0 12px #ff3b3b; }
}

/* ì—°ìŠ¹/ì—°íŒ¨ ìƒ‰ ì§„í•˜ê¸° */
.streak-2.win { color:#fff59d; } /* ì—°í•œ ë…¸ë‘ */
.streak-3.win { color:#ffe066; } /* ì¤‘ê°„ ë…¸ë‘ */
.streak-4.win { color:#ffd700; } /* ì§„í•œ ë…¸ë‘ */
.streak-2.lose { color:#ff8a80; } /* ì—°í•œ ë¹¨ê°• */
.streak-3.lose { color:#ff5252; } /* ì¤‘ê°„ ë¹¨ê°• */
.streak-4.lose { color:#ff1744; } /* ì§„í•œ ë¹¨ê°• */
</style>
</head>

<body>
<div class="container">

  <!-- RED -->
  <div class="team red">
    <h1 id="redName">RED TEAM</h1>
    <div class="summary" id="redSummary"></div>
    <div class="members" id="redPlayers"></div>
  </div>

  <!-- BLUE -->
  <div class="team blue">
    <h1 id="blueName">BLUE TEAM</h1>
    <div class="summary" id="blueSummary"></div>
    <div class="members" id="bluePlayers"></div>
  </div>

</div>

<script>
const SUPABASE_URL = "https://hsvknfmnsehwytnvaiwr.supabase.co";
const SUPABASE_KEY = "sb_publishable_l2wj1IeGSfcxgKVjJ28n0w_WK9iHm-j";
const sb = supabase.createClient(SUPABASE_URL, SUPABASE_KEY);

function getStreakClass(streak){
  const abs = Math.abs(streak);
  if(abs >=4) return 4;
  if(abs ===3) return 3;
  if(abs ===2) return 2;
  return 1;
}

async function render() {
  const { data: players } = await sb.from('players').select('*');
  const { data: setting } = await sb.from('settings').select('*').single();

  document.getElementById('redName').textContent = setting.red_team_name;
  document.getElementById('blueName').textContent = setting.blue_team_name;

  const red = players.filter(p=>p.team==='red');
  const blue = players.filter(p=>p.team==='blue');

  renderTeam(red,'redPlayers','redSummary',setting.blue_team_name);
  renderTeam(blue,'bluePlayers','blueSummary',setting.red_team_name);
}

function renderTeam(list, containerId, summaryId, opponentName) {
  const container = document.getElementById(containerId);
  container.innerHTML = '';

  let w=0, l=0;

  list.forEach(p=>{
    w+=p.wins;
    l+=p.losses;

    let streakText = '';
    let streakClass = '';
    if(p.streak >0){
      streakText = `â­${p.streak}ì—°ìŠ¹`;
      streakClass = `streak win streak-${getStreakClass(p.streak)}`;
    } else if(p.streak <0){
      streakText = `ğŸ’€${Math.abs(p.streak)}ì—°íŒ¨`;
      streakClass = `streak lose streak-${getStreakClass(p.streak)}`;
    }

    let borderAnim = '';
    if(p.streak>0) borderAnim='animation:borderGlowYellow 1s infinite';
    if(p.streak<0) borderAnim='animation:borderGlowRed 1s infinite';

    container.insertAdjacentHTML('beforeend',`
      <div class="member-card" style="${borderAnim}">
        <div class="name">${p.name} ${streakText ? `<span class="${streakClass}">${streakText}</span>` : ''}</div>
        <div class="vs">VS ${opponentName}</div>
        <div class="record">
          <span class="win">ğŸ˜ ${p.wins}</span> /
          <span class="lose">ğŸ˜¡ ${p.losses}</span>
        </div>
      </div>
    `);
  });

  const summaryEl = document.getElementById(summaryId);
  summaryEl.innerHTML = `<span class="win">ğŸ˜ ${w}ìŠ¹</span> / <span class="lose">ğŸ˜¡ ${l}íŒ¨</span>`;
}

/* ìµœì´ˆ ë Œë” */
render();

/* ì‹¤ì‹œê°„ ë°˜ì˜ */
sb.channel('realtime')
  .on('postgres_changes',{event:'*',schema:'public',table:'players'},render)
  .on('postgres_changes',{event:'*',schema:'public',table:'settings'},render)
  .subscribe();
</script>

</body>
</html>

























