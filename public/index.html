<!DOCTYPE html>
<html lang="ko">
<head>
<meta charset="UTF-8">
<title>ÏÜîÎû≠ ÎÇ¥Í∏∞ ÏÜ°Ï∂ú Ìå®ÎÑê</title>
<link href="https://fonts.googleapis.com/css2?family=Pretendard:wght@500;600&family=Orbitron:wght@600&display=swap" rel="stylesheet">
<script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
<style>
body {
  margin:0;
  background:#000;
  color:#fff;
  font-family:'Pretendard', sans-serif;
  display:flex;
  justify-content:center;
  align-items:flex-start;
  height:100vh;
}

.container {
  display:flex;
  justify-content:center;
  align-items:flex-start;
  gap:40px;
}

.team {
  display:flex;
  flex-direction:column;
  align-items:center;
}

.red h1 { color:#ff5c5c; }
.blue h1 { color:#4db8ff; }

.team h1 {
  text-align:center;
  font-size:26px;
  margin-bottom:6px;
  letter-spacing:1.5px;
  font-family:'Orbitron', sans-serif;
}

.summary {
  text-align:center;
  font-size:13px;
  margin-bottom:4px;
  animation:scoreGlow 1.4s infinite;
}

@keyframes scoreGlow {
  0%,100% { text-shadow:0 0 4px #fff; opacity:0.7; }
  50% { text-shadow:0 0 12px #fff; opacity:1; }
}

.members {
  display:flex;
  flex-direction:column;
  align-items:center;
  gap:4px;
}

.member-card {
  background:rgba(255,255,255,0.05);
  border:2px solid rgba(255,255,255,0.2);
  border-radius:10px;
  padding:6px 10px;
  width:220px;
  min-height:90px;
  text-align:center;
  font-size:12px;
  display:flex;
  flex-direction:column;
  justify-content:center;
  gap:2px;
  transition: transform 0.2s;
}

.member-card:hover { transform:scale(1.03); }

.name {
  font-weight:600;
  font-family:'Orbitron',sans-serif;
  font-size:13px;
  margin-bottom:2px;
}

.record {
  display:flex;
  justify-content:center;
  gap:4px;
  font-weight:500;
  font-size:11px;
  margin-bottom:2px;
}

.win { color:#ffd369; }
.lose { color:#ff6b6b; }

.recent {
  display:flex;
  justify-content:center;
  gap:3px;
}

.recent-dot {
  width:13px;
  height:13px;
  border-radius:50%;
  display:inline-block;
}

.recent-dot.win { background:#ffd369; }
.recent-dot.lose { background:#ff6b6b; }
.recent-dot.empty { background:#555; }

.champions {
  display:flex;
  justify-content:center;
  flex-wrap:wrap;
  gap:3px;
  margin-top:2px;
}

.champions img {
  width:20px;
  height:20px;
  border-radius:3px;
}

.streak {
  font-size:11px;
  font-weight:600;
  margin-left:3px;
}
</style>
</head>
<body>
<div class="container">
  <div class="team red">
    <h1 id="redName">RED TEAM</h1>
    <div class="summary" id="redSummary"></div>
    <div class="members" id="redPlayers"></div>
  </div>
  <div class="team blue">
    <h1 id="blueName">BLUE TEAM</h1>
    <div class="summary" id="blueSummary"></div>
    <div class="members" id="bluePlayers"></div>
  </div>
</div>

<script>
const SUPABASE_URL="https://hsvknfmnsehwytnvaiwr.supabase.co";
const SUPABASE_KEY="sb_publishable_l2wj1IeGSfcxgKVjJ28n0w_WK9iHm-j";
const sb=supabase.createClient(SUPABASE_URL,SUPABASE_KEY);

function getStreakClass(streak){
  const abs=Math.abs(streak);
  if(abs>=7)return 7;
  if(abs===6)return 6;
  if(abs===5)return 5;
  if(abs===4)return 4;
  if(abs===3)return 3;
  if(abs===2)return 2;
  return 1;
}

async function render(){
  const {data:players} = await sb.from('players').select('*');
  const {data:setting} = await sb.from('settings').select('*').single();
  document.getElementById('redName').textContent=setting.red_team_name;
  document.getElementById('blueName').textContent=setting.blue_team_name;
  renderTeam(players.filter(p=>p.team==='red'),'redPlayers','redSummary');
  renderTeam(players.filter(p=>p.team==='blue'),'bluePlayers','blueSummary');
}

function renderTeam(list, containerId, summaryId){
  const container=document.getElementById(containerId);
  container.innerHTML='';
  let totalWin=0,totalLose=0;

  list.forEach(p=>{
    totalWin+=p.wins;
    totalLose+=p.losses;

    let streakText='', streakClass='';
    if(p.streak>0){ streakText=`‚≠ê${p.streak}Ïó∞Ïäπ`; streakClass=`streak win streak-${getStreakClass(p.streak)}`;}
    else if(p.streak<0){ streakText=`üíÄ${Math.abs(p.streak)}Ïó∞Ìå®`; streakClass=`streak lose streak-${getStreakClass(p.streak)}`;}

    // ÏµúÍ∑º 10Ï†Ñ
    let recentHTML='';
    if(p.recent && p.recent.length){
      const arr=p.recent.slice(-10);
      arr.forEach(r=>{
        if(r==='win') recentHTML+='<span class="recent-dot win"></span>';
        else if(r==='lose') recentHTML+='<span class="recent-dot lose"></span>';
        else recentHTML+='<span class="recent-dot empty"></span>';
      });
      while(recentHTML.split('<span').length-1<10){recentHTML+='<span class="recent-dot empty"></span>';}
    } else { recentHTML='<span class="recent-dot empty"></span>'.repeat(10); }

    // Ï±îÌîºÏñ∏ ÏïÑÏù¥ÏΩò
    let champHTML='';
    if(p.champions && Array.isArray(p.champions)){
      p.champions.forEach(c=>{
        const src=`https://ddragon.leagueoflegends.com/cdn/16.3.1/img/champion/${c}.png`;
        champHTML+=`<img src="${src}" alt="${c}">`;
      });
    }

    container.insertAdjacentHTML('beforeend',`
      <div class="member-card">
        <div class="name">${p.name} ${streakText ? `<span class="${streakClass}">${streakText}</span>` : ''}</div>
        <div class="record"><span class="win">üòÅ ${p.wins}Ïäπ</span> / <span class="lose">üò° ${p.losses}Ìå®</span></div>
        <div class="recent">${recentHTML}</div>
        <div class="champions">${champHTML}</div>
      </div>
    `);
  });

  const summaryEl=document.getElementById(summaryId);
  summaryEl.innerHTML=`<span class="win">üòÅ ${totalWin}Ïäπ</span> / <span class="lose">üò° ${totalLose}Ìå®</span>`;
}

render();
sb.channel('realtime')
  .on('postgres_changes',{event:'*',schema:'public',table:'players'},render)
  .on('postgres_changes',{event:'*',schema:'public',table:'settings'},render)
  .subscribe();
</script>
</body>
</html>




































