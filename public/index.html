<!DOCTYPE html>
<html lang="ko">
<head>
<meta charset="UTF-8">
<title>Ïù¥ÎùºÎÑ§ ÏÜîÎû≠ ÎÇ¥Í∏∞ ÏÜ°Ï∂úÏö©</title>
<link href="https://fonts.googleapis.com/css2?family=Pretendard:wght@600;800&family=Orbitron:wght@600;800&display=swap" rel="stylesheet">
<script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
<style>
    /* Í∏∞Ï°¥ Ïä§ÌÉÄÏùº Ï†ÑÏ≤¥ Î≥µÍµ¨ */
    body{margin:0; background:#000; color:#fff; font-family:'Pretendard',sans-serif; overflow:hidden;}
    .scene{position:absolute; inset:0; opacity:0; transition:opacity .6s ease; display:none;}
    .scene.active{opacity:1; z-index:1; display:block;}
    .container{display:flex; gap:60px; justify-content:center; margin-top:20px;}
    .team h1{font-family:'Orbitron',sans-serif; font-size:50px; margin-bottom:4px;}
    .red h1{color:#ff5c5c} .blue h1{color:#4db8ff;}
    .summary{font-size:26px; font-weight:800; margin-bottom:12px;}
    .summary .win{color:#ffd369; text-shadow:0 0 12px #ffd369;}
    .summary .lose{color:#ff6b6b; text-shadow:0 0 12px #ff6b6b;}
    .member-card{position:relative; width:260px; padding:18px 10px 12px; background:rgba(255,255,255,.06); border-radius:14px; border:2px solid rgba(120,120,120,.35); text-align:center; margin-bottom:10px;}
    .wl-badge { position: absolute; top: -9px; left: 50%; transform: translateX(-50%); width: 15px; height: 15px; background: #000; border: 1px solid rgba(255,255,255,0.3); border-radius: 3px; font-size: 9px; font-weight: 900; display: flex; align-items: center; justify-content: center; }
    .wl-badge.win { color: #ffd369; border-color: #ffd369; }
    .wl-badge.lose { color: #ff4d4d; border-color: #ff4d4d; }
    .wl-badge.ing { color: #777; border-color: #444; }

    /* ÌÉÄÏù¥Î®∏ Î∞è Ïä§ÏΩîÏñ¥Î≥¥Îìú UI Î≥µÍµ¨ */
    .score-board{margin-top:100px; text-align:center; font-family:'Orbitron',sans-serif;}
    .timer{font-size:38px; font-weight:800; margin-bottom:20px;}
    .timer .clock{display:inline-block; animation:shakeClock 0.8s infinite;}
    @keyframes shakeClock{0%{transform:translateX(0);}25%{transform:translateX(-4px);}50%{transform:translateX(4px);}75%{transform:translateX(-4px);}100%{transform:translateX(0);}}
    .vs {font-size:38px;margin-bottom:30px; display:flex; justify-content:center; align-items:center; gap:20px;}
    .vs .vs-text { font-weight:900; color:#fff; text-shadow:0 0 4px #fff; animation:vsGlow 1.2s infinite alternate;}
    @keyframes vsGlow{0%{transform:rotate(-3deg);} 50%{text-shadow:0 0 14px #ffea00; transform:rotate(3deg);} 100%{transform:rotate(-3deg);}}
    .score-wrap{display:flex; justify-content:center; gap:140px;}
    .score{font-size:130px; text-shadow:0 0 18px #fff;}
    .score.win { animation: glowEffect 1.2s infinite alternate; color: #ffd369; }
    @keyframes glowEffect { 0% { transform: scale(1); text-shadow:0 0 10px #ffd369;} 100% { transform: scale(1.15); text-shadow:0 0 30px #ffd369;}}
    .summary-small { font-size: 20px; font-weight: 800; color: #ff6b6b; margin-top: -20px; }
</style>
</head>
<body>
<div class="scene active" id="scene-all"></div>
<div class="scene" id="scene-red"></div>
<div class="scene" id="scene-blue"></div>
<div class="scene" id="scene-score"></div>

<script>
const SUPABASE_URL = "https://hsvknfmnsehwytnvaiwr.supabase.co";
const SUPABASE_KEY = "sb_publishable_l2wj1IeGSfcxgKVjJ28n0w_WK9iHm-j";
const sb = supabase.createClient(SUPABASE_URL, SUPABASE_KEY);

let players = [], settings = { red_team_name: 'RED', blue_team_name: 'BLUE' };
let seconds = 12 * 60 + 34; // Í∏∞Î≥∏Í∞í

async function loadData() {
    const { data: sData } = await sb.from('settings').select('*').single();
    const { data: pData } = await sb.from('players').select('*');
    if(sData) {
        settings = sData;
        // Í¥ÄÎ¶¨Ïûê Ìå®ÎÑêÏóêÏÑú Î∞òÏòÅ ÎàÑÎ•º ÎïåÎßàÎã§ ÌÉÄÏù¥Î®∏Î•º Ï¥àÍ∏∞ÌôîÌïòÍ≥† Ïã∂Îã§Î©¥ Ïó¨Í∏∞ÏÑú ÏÑ∏ÌåÖ
    }
    if(pData) players = pData;
    renderAll();
}

function renderAll() {
    renderScene(document.getElementById('scene-all'));
    renderScene(document.getElementById('scene-red'), 'red');
    renderScene(document.getElementById('scene-blue'), 'blue');
    renderScoreBoard();
}

function renderScene(container, team = null) {
    const list = team ? players.filter(p => p.team === team) : players;
    container.innerHTML = `<div class="container">${['red','blue'].map(t => {
        if(team && team !== t) return '';
        const arr = players.filter(p => p.team === t);
        const win = arr.reduce((a, b) => a + b.wins, 0);
        const lose = arr.reduce((a, b) => a + b.losses, 0);
        return `<div class="team ${t}">
            <h1>${(t === 'red' ? settings.red_team_name : settings.blue_team_name).toUpperCase()}</h1>
            <div class="summary"><span class="win">üòÅ ${win}Ïäπ</span> / <span class="lose">üò° ${lose}Ìå®</span></div>
            <div class="members">${arr.map(p => `
                <div class="member-card">
                    <div style="font-size:18px; font-weight:800;">${p.name}</div>
                    <div style="font-size:14px; margin:5px 0;"><span style="color:#ffd369">üòÅ ${p.wins}Ïäπ</span> / <span style="color:#ff6b6b">üò° ${p.losses}Ìå®</span></div>
                    <div style="display:flex; justify-content:center; gap:5px;">${p.recent.map((r, i) => `
                        <div style="position:relative; width:22px; height:22px;">
                            <img src="https://ddragon.leagueoflegends.com/cdn/14.3.1/img/champion/${p.champions[i]}.png" style="width:100%; border-radius:4px;">
                            <span class="wl-badge ${r}">${r === 'win' ? 'W' : r === 'lose' ? 'L' : '...'}</span>
                        </div>`).join('')}</div>
                </div>`).join('')}</div>
        </div>`;
    }).join('')}</div>`;
}

function renderScoreBoard() {
    const rW = players.filter(p=>p.team==='red').reduce((a,b)=>a+b.wins,0);
    const rL = players.filter(p=>p.team==='red').reduce((a,b)=>a+b.losses,0);
    const bW = players.filter(p=>p.team==='blue').reduce((a,b)=>a+b.wins,0);
    const bL = players.filter(p=>p.team==='blue').reduce((a,b)=>a+b.losses,0);

    document.getElementById('scene-score').innerHTML = `
        <div class="score-board">
            <div class="timer"><span class="clock">‚è∞</span> <span class="time-text">00:00</span></div>
            <div class="vs">
                <span style="color:#ff5c5c">${settings.red_team_name}</span>
                <span class="vs-text">VS</span>
                <span style="color:#4db8ff">${settings.blue_team_name}</span>
            </div>
            <div class="score-wrap">
                <div class="score ${rW > bW ? 'win' : ''}">${rW}<div class="summary-small">Ìå®Î∞∞ : ${rL}</div></div>
                <div class="score ${bW > rW ? 'win' : ''}">${bW}<div class="summary-small">Ìå®Î∞∞ : ${bL}</div></div>
            </div>
        </div>`;
}

// ÌÉÄÏù¥Î®∏ ÏûëÎèô Î°úÏßÅ
setInterval(() => {
    if(seconds > 0) seconds--;
    const m = String(Math.floor(seconds / 60)).padStart(2, '0');
    const s = String(seconds % 60).padStart(2, '0');
    const timeText = document.querySelector('.time-text');
    if(timeText) timeText.textContent = `ÎÇ®ÏùÄÏãúÍ∞Ñ : ${m}:${s}`;
}, 1000);

sb.channel('db').on('postgres_changes',{event:'*',schema:'public',table:'settings'},() => {
    // ÏÑ∏ÌåÖ Î≥ÄÍ≤Ω Ïãú ÌÉÄÏù¥Î®∏ Ïû¨ÏÑ§Ï†ï (Í¥ÄÎ¶¨Ïûê Ìå®ÎÑê Î°úÏßÅÍ≥º Ïó∞Îèô)
    loadData();
    // Ïã§Ï†ú Ïö¥ÏòÅ ÏãúÏóêÎäî DBÏùò updated_atÏùÑ Î≥¥Í≥† ÏãúÍ∞ÑÏùÑ ÎèôÍ∏∞ÌôîÌïòÎäî Î°úÏßÅÏù¥ ÌïÑÏöîÌïòÎÇò, ÏùºÎã® Î°úÏª¨ Ï¥àÍ∏∞Í∞í Ïú†ÏßÄ
}).on('postgres_changes',{event:'*',schema:'public',table:'players'},loadData).subscribe();

let idx = 0;
setInterval(() => {
    const scenes = document.querySelectorAll('.scene');
    scenes[idx].classList.remove('active');
    idx = (idx + 1) % 4;
    scenes[idx].classList.add('active');
}, 8000);

loadData();
</script>
</body>
</html>















































