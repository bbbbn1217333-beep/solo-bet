<!DOCTYPE html>
<html lang="ko">
<head>
<meta charset="UTF-8">
<title>ì†”ëž­ ë‚´ê¸°</title>

<link href="https://fonts.googleapis.com/css2?family=Orbitron:wght@600;800&display=swap" rel="stylesheet">

<style>
body {
  margin:0;
  background:#0b0b0b;
  color:#fff;
  font-family:'Orbitron', sans-serif;
}

.container { display:flex; height:100vh; }
.team { flex:1; padding:20px; }

.red { background:linear-gradient(180deg,#2a0000,#0b0b0b); }
.blue { background:linear-gradient(180deg,#001a2a,#0b0b0b); }

.team h1 {
  text-align:center;
  font-size:32px;
}

.red h1 { color:#ff4444; text-shadow:0 0 12px #ff4444; }
.blue h1 { color:#44aaff; text-shadow:0 0 12px #44aaff; }

.summary { text-align:center; margin-bottom:10px; }

.streak-win { animation:pulse 1s infinite; }
.streak-lose { opacity:0.6; }

@keyframes pulse {
  0% { text-shadow:0 0 5px #00ff99; }
  50% { text-shadow:0 0 20px #00ff99; }
  100% { text-shadow:0 0 5px #00ff99; }
}

table { width:100%; border-collapse:collapse; }
th,td { padding:6px; text-align:center; }
th { border-bottom:2px solid #444; }
tr:nth-child(even) { background:#111; }
</style>
</head>

<body>
<div class="container">

<div class="team red">
  <h1 id="redName"></h1>
  <div class="summary" id="redSummary"></div>
  <table>
    <thead><tr><th>ë‹‰ë„¤ìž„</th><th>ìŠ¹</th><th>íŒ¨</th></tr></thead>
    <tbody id="redPlayers"></tbody>
  </table>
</div>

<div class="team blue">
  <h1 id="blueName"></h1>
  <div class="summary" id="blueSummary"></div>
  <table>
    <thead><tr><th>ë‹‰ë„¤ìž„</th><th>ìŠ¹</th><th>íŒ¨</th></tr></thead>
    <tbody id="bluePlayers"></tbody>
  </table>
</div>

</div>

<script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
<script>
const SUPABASE_URL = "https://hsvknfmnsehwytnvaiwr.supabase.co";
const SUPABASE_KEY = "sb_publishable_l2wj1IeGSfcxgKVjJ28n0w_WK9iHm-j";
const sb = supabase.createClient(SUPABASE_URL, SUPABASE_KEY);

async function render() {
  const { data: players } = await sb.from('players').select('*');
  const { data: setting } = await sb.from('settings').select('*').single();

  redName.textContent = setting.red_team_name;
  blueName.textContent = setting.blue_team_name;

  renderTeam(players.filter(p=>p.team==='red'), 'redPlayers', 'redSummary');
  renderTeam(players.filter(p=>p.team==='blue'), 'bluePlayers', 'blueSummary');
}

function renderTeam(list, bodyId, summaryId) {
  const body = document.getElementById(bodyId);
  body.innerHTML = '';

  let w=0,l=0,streak=0;

  list.forEach(p=>{
    w+=p.wins;
    l+=p.losses;
    streak+=p.streak;
    body.insertAdjacentHTML('beforeend',`
      <tr>
        <td>${p.name}</td>
        <td>${p.wins}</td>
        <td>${p.losses}</td>
      </tr>
    `);
  });

  const s = document.getElementById(summaryId);
  s.innerHTML = `${w}ìŠ¹ ${l}íŒ¨<br>${streak>0?`ðŸ”¥ ${streak}ì—°ìŠ¹`:streak<0?`ðŸ’€ ${-streak}ì—°íŒ¨`:''}`;
  s.className = streak>0?'streak-win':streak<0?'streak-lose':'';
}

render();

sb.channel('realtime')
  .on('postgres_changes',{event:'*',schema:'public',table:'players'},render)
  .on('postgres_changes',{event:'*',schema:'public',table:'settings'},render)
  .subscribe();
</script>
</body>
</html>















