<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8">
  <title>솔랭 내기 관리자 패널</title>
  <style>
    body { font-family: 'Segoe UI', sans-serif; padding:20px; }
    input { margin:5px; padding:5px; width:150px; }
    button { padding:5px 10px; margin:10px 0; }
  </style>
</head>
<body>

<h2>관리자 패널</h2>
<label>팀 인원 수: <input type="number" id="teamCount" value="5" min="1" max="10"></label>
<button onclick="applySettings()">적용</button>

<div id="playerInputs"></div>

<!-- Supabase JS SDK 연결 -->
<script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js"></script>
<script>
  const supabaseUrl = 'https://hsvknfmnsehwytnvaiwr.supabase.co';
  const supabaseKey = 'sb_publishable_l2wj1IeGSfcxgKVjJ28n0w_WK9iHm-j';
  const supabase = supabase.createClient(supabaseUrl, supabaseKey);
</script>

<script>
function generateInputs(teamCount){
  const container = document.getElementById('playerInputs');

  for(let i=1;i<=teamCount;i++){
    // 기존 value 유지
    const oldOur = document.getElementById(`our-${i}`)?.value || '';
    const oldOpp = document.getElementById(`opp-${i}`)?.value || '';

    // 우리팀 input
    let ourInput = document.getElementById(`our-${i}`);
    if(!ourInput){
      ourInput = document.createElement('input');
      ourInput.id = `our-${i}`;
      ourInput.placeholder = `우리팀 플레이어 ${i}`;
      container.appendChild(ourInput);
    }
    ourInput.value = oldOur;

    // 상대팀 input
    let oppInput = document.getElementById(`opp-${i}`);
    if(!oppInput){
      oppInput = document.createElement('input');
      oppInput.id = `opp-${i}`;
      oppInput.placeholder = `상대팀 플레이어 ${i}`;
      container.appendChild(oppInput);
    }
    oppInput.value = oldOpp;

    container.appendChild(document.createElement('br'));
  }
}

async function applySettings(){
  const teamCount = parseInt(document.getElementById('teamCount').value);
  generateInputs(teamCount);

  const players = [];
  for(let i=1;i<=teamCount;i++){
    const ourName = document.getElementById(`our-${i}`).value.trim();
    const oppName = document.getElementById(`opp-${i}`).value.trim();
    if(ourName) players.push({name: ourName, team:'우리팀', wins:0, losses:0, streak:0});
    if(oppName) players.push({name: oppName, team:'상대팀', wins:0, losses:0, streak:0});
  }

  if(players.length){
    const { data, error } = await supabase.from('players').upsert(players);
    if(error) console.log('DB 저장 오류:', error);
    else alert('적용 완료!');
  }
}

// 처음 로드 시 기본 입력창 생성
generateInputs(parseInt(document.getElementById('teamCount').value));
</script>
</body>
</html>




