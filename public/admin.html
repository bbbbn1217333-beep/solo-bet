<!DOCTYPE html>
<html lang="ko">
<head>
<meta charset="UTF-8">
<title>솔랭 내기 관리자 패널</title>

<!-- 폰트 적용 -->
<link href="https://fonts.googleapis.com/css2?family=Pretendard:wght@600;800&family=Orbitron:wght@600;800&display=swap" rel="stylesheet">

<script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>

<style>
body {
  margin:0;
  background:#0e0e0e;
  color:#fff;
  font-family:'Pretendard', sans-serif;
  display:flex;
  justify-content:center;
  padding:20px;
}

.wrap {
  max-width:1200px;
  width:100%;
  display:flex;
  flex-direction:column;
  align-items:center;
  gap:20px;
}

/* 팀 이름 입력 */
.top {
  display:flex;
  gap:10px;
  width:100%;
  justify-content:center;
  align-items:center;
}

.top label {
  font-size:16px;
  margin-right:4px;
}

.top input[type="text"], .top input[type="number"] {
  flex:1;
  padding:10px;
  background:#111;
  border:1px solid #444;
  color:#fff;
  border-radius:8px;
  font-size:16px;
  text-align:center;
  font-family:'Pretendard', sans-serif;
  outline:none;
}

/* 팀 영역 */
.teams {
  display:flex;
  gap:80px;
  width:100%;
  justify-content:center;
}

.team {
  display:flex;
  flex-direction:column;
  align-items:center;
}

.team h2 {
  font-family:'Orbitron', sans-serif;
  font-size:28px;
  margin-bottom:10px;
}

#redTeamHeader { color:#ff5c5c; }
#blueTeamHeader { color:#4db8ff; }

/* 멤버 카드 */
.members {
  display:flex;
  flex-direction:column;
  gap:10px;
  width:220px;
}

.member-card {
  background:#111;
  border:2px solid #444;
  border-radius:12px;
  padding:10px;
  width:100%;
  font-family:'Pretendard', sans-serif;
  font-size:16px;
  color:#fff;
  text-align:center;
  outline:none;
}

/* 버튼 */
.actions {
  margin-top:20px;
  text-align:center;
}
button {
  padding:12px 30px;
  background:#ff3b3b;
  border:none;
  color:#fff;
  font-size:16px;
  border-radius:6px;
  cursor:pointer;
}

/* 승패 입력 버튼 */
.recent-buttons {
  display:flex;
  gap:6px;
  justify-content:center;
  margin-top:4px;
}

.recent-buttons button {
  padding:4px 8px;
  font-size:14px;
  border-radius:6px;
  border:none;
  cursor:pointer;
}

.win-btn { background:#ffd369; color:#000; }
.lose-btn { background:#ff6b6b; color:#fff; }
</style>
</head>

<body>

<div class="wrap">

  <!-- 팀 이름 & 멤버 수 -->
  <div class="top">
    <label>팀 이름</label>
    <input id="redTeamName" placeholder="팀 이름">
    <input id="blueTeamName" placeholder="팀 이름">
    <label>멤버 구성 수</label>
    <input id="teamCount" type="number" min="1" max="33" value="5">
  </div>

  <!-- 팀 카드 -->
  <div class="teams">

    <div class="team">
      <h2 id="redTeamHeader">팀 이름</h2>
      <div class="members" id="redPlayers"></div>
    </div>

    <div class="team">
      <h2 id="blueTeamHeader">팀 이름</h2>
      <div class="members" id="bluePlayers"></div>
    </div>

  </div>

  <div class="actions">
    <button onclick="applyAll()">적용</button>
  </div>

</div>

<script>
/* ===== Supabase ===== */
const SUPABASE_URL = "https://hsvknfmnsehwytnvaiwr.supabase.co";
const SUPABASE_KEY = "sb_publishable_l2wj1IeGSfcxgKVjJ28n0w_WK9iHm-j";
const sb = supabase.createClient(SUPABASE_URL, SUPABASE_KEY);

/* ===== DOM ===== */
const redWrap = document.getElementById('redPlayers');
const blueWrap = document.getElementById('bluePlayers');
const teamCountInput = document.getElementById('teamCount');
const redHeader = document.getElementById('redTeamHeader');
const blueHeader = document.getElementById('blueTeamHeader');
const redNameInput = document.getElementById('redTeamName');
const blueNameInput = document.getElementById('blueTeamName');

/* ===== 입력 생성 ===== */
function createInputs() {
  const count = Number(teamCountInput.value);
  redWrap.innerHTML = '';
  blueWrap.innerHTML = '';

  for (let i=0;i<count;i++) {
    const r = document.createElement('input');
    r.placeholder = `멤버 ${i+1}`;
    r.className='member-card';
    r.addEventListener('keydown', e => {
      if (e.key==='Enter') e.preventDefault(); // 엔터 눌러도 입력 유지
    });
    redWrap.appendChild(r);

    const b = document.createElement('input');
    b.placeholder = `멤버 ${i+1}`;
    b.className='member-card';
    b.addEventListener('keydown', e => {
      if (e.key==='Enter') e.preventDefault();
    });
    blueWrap.appendChild(b);
  }
}

/* 팀 이름 변경시 실시간 반영 */
redNameInput.addEventListener('input',()=>{ redHeader.textContent = redNameInput.value || '팀 이름'; });
blueNameInput.addEventListener('input',()=>{ blueHeader.textContent = blueNameInput.value || '팀 이름'; });

teamCountInput.addEventListener('change', createInputs);
createInputs();

/* ===== 적용 ===== */
async function applyAll() {

  const redNames = [...redWrap.querySelectorAll('input')]
    .map(i=>i.value.trim()).filter(Boolean);

  const blueNames = [...blueWrap.querySelectorAll('input')]
    .map(i=>i.value.trim()).filter(Boolean);

  if (!redNames.length || !blueNames.length) {
    alert('플레이어를 입력하세요');
    return;
  }

  /* settings 저장 (항상 id=1) */
  await sb.from('settings').upsert({
    id:1,
    red_team_name: redNameInput.value || '팀 이름',
    blue_team_name: blueNameInput.value || '팀 이름'
  });

  /* players 리셋 */
  await sb.from('players').delete().neq('id',0);

  /* players 삽입 */
  const players = [
    ...redNames.map(name=>({
      name,
      team:'red',
      wins:0,
      losses:0,
      streak:0,
      recent:[] // JSONB 컬럼
    })),
    ...blueNames.map(name=>({
      name,
      team:'blue',
      wins:0,
      losses:0,
      streak:0,
      recent:[]
    }))
  ];

  await sb.from('players').insert(players);

  alert('적용 완료');
}
</script>

</body>
</html>





















