<!DOCTYPE html>
<html lang="ko">
<head>
<meta charset="UTF-8">
<title>ì´ë¼ë„¤ ì†”ë­ ë‚´ê¸° ê´€ë¦¬ììš©</title>
<link href="https://fonts.googleapis.com/css2?family=Pretendard:wght@600;800&family=Orbitron:wght@600;800&display=swap" rel="stylesheet">
<script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
<style>
    :root { 
        --red: #ff3b3b; --blue: #4db8ff; --gold: #ffd369; --ing: #555;
        --neon-red: 0 0 12px rgba(255, 59, 59, 0.7);
        --neon-blue: 0 0 12px rgba(77, 184, 255, 0.7);
        --neon-gold: 0 0 10px rgba(255, 211, 105, 0.5);
    }
    body { margin:0; background:#0e0e0e; color:#fff; font-family:'Pretendard',sans-serif; padding:20px; padding-bottom: 120px; }
    .wrap { width:1450px; margin:0 auto; display:flex; flex-direction:column; gap:20px; }
    .admin-header { background:#1a1a1a; padding:25px; border-radius:15px; border:1px solid #333; }
    .top-controls { display:flex; gap:20px; align-items:center; margin-bottom:20px; flex-wrap: wrap; }
    .top-controls input { padding:12px; background:#000; border:1px solid #444; color:#fff; border-radius:8px; font-size:16px; font-weight:800; }
    #redNameInput { border-left: 5px solid var(--red); color: var(--red); box-shadow: var(--neon-red); }
    #blueNameInput { border-left: 5px solid var(--blue); color: var(--blue); box-shadow: var(--neon-blue); }
    .timer-input-wrap { display: flex; align-items: center; gap: 10px; background: #222; padding: 10px 15px; border-radius: 10px; border: 1px solid var(--gold); }
    .timer-input-wrap input { width: 60px; text-align: center; color: var(--gold); border-color: var(--gold); }
    .teams-container { display:flex; gap:25px; }
    .team-box { flex:1; background:#1a1a1a; padding:20px; border-radius:15px; border-top:5px solid #444; }
    .team-box.red { border-color: var(--red); }
    .team-box.blue { border-color: var(--blue); }
    .member-card { background:#1e1e1e; border-radius:12px; padding:20px; margin-bottom: 20px; border: 1.5px solid #333; }
    .team-box.red .member-card { border-color: var(--red); box-shadow: var(--neon-red); }
    .team-box.blue .member-card { border-color: var(--blue); box-shadow: var(--neon-blue); }
    .history-editor { display:grid; grid-template-columns: repeat(5, 1fr); gap:10px; background:#0c0c0c; padding:12px; border-radius:10px; }
    .history-item { display:flex; flex-direction:column; gap:6px; align-items:center; padding:10px 5px; background:#1e1e1e; border-radius:8px; border:1px solid #333; }
    .btn-toggle { width:100%; padding:8px 0; font-size:12px; font-weight:900; border:none; border-radius:4px; cursor:pointer; }
    .btn-toggle.win { background: var(--gold); color: #000; }
    .btn-toggle.lose { background: var(--red); color: #fff; }
    .btn-toggle.ing { background: var(--ing); color: #ccc; }
    .btn-apply { position: fixed; bottom: 30px; right: 30px; width: 280px; height: 70px; font-size:24px; font-weight:800; background: var(--red); color:#fff; border:none; border-radius:15px; cursor:pointer; box-shadow: 0 0 25px rgba(255, 59, 59, 0.6); }
</style>
</head>
<body>
<div class="wrap">
    <div class="admin-header">
        <div class="top-controls">
            <input id="redNameInput" value="ë ˆë“œ íŒ€">
            <input id="blueNameInput" value="ë¸”ë£¨ íŒ€">
            <div class="timer-input-wrap">
                <span style="color:var(--gold); font-weight:800;">â° íƒ€ì´ë¨¸:</span>
                <input id="timerMin" type="number" value="12"> ë¶„
                <input id="timerSec" type="number" value="34"> ì´ˆ
            </div>
            <label style="color:var(--gold); font-weight:800;">ì¸ì›: </label>
            <input id="teamCount" type="number" value="5" onchange="rebuild()" style="width:70px;">
        </div>
    </div>
    <div class="teams-container">
        <div class="team-box red"><h2 style="text-align:center; color:var(--red);">RED</h2><div id="redPlayers" class="member-list"></div></div>
        <div class="team-box blue"><h2 style="text-align:center; color:var(--blue);">BLUE</h2><div id="bluePlayers" class="member-list"></div></div>
    </div>
</div>
<button class="btn-apply" onclick="applyToSupabase()">ì†¡ì¶œ í™”ë©´ ë°˜ì˜</button>

<script>
const SUPABASE_URL = "https://hsvknfmnsehwytnvaiwr.supabase.co";
const SUPABASE_KEY = "sb_publishable_l2wj1IeGSfcxgKVjJ28n0w_WK9iHm-j";
const sb = supabase.createClient(SUPABASE_URL, SUPABASE_KEY);

function toggleResult(btn) {
    if (btn.innerText.includes('ìŠ¹ë¦¬')) { btn.innerText = 'ğŸ˜¡ íŒ¨ë°°'; btn.className = 'btn-toggle lose'; }
    else if (btn.innerText.includes('íŒ¨ë°°')) { btn.innerText = 'ğŸ•’ ì§„í–‰'; btn.className = 'btn-toggle ing'; }
    else { btn.innerText = 'ğŸ˜ ìŠ¹ë¦¬'; btn.className = 'btn-toggle win'; }
}

function createMemberCard(team) {
    const card = document.createElement('div'); card.className = 'member-card';
    let hHTML = '';
    for(let i=1; i<=10; i++) hHTML += `<div class="history-item"><span>${i}íŒ</span><input type="text" class="champ-input" style="width:90%; background:#000; color:#fff; border:1px solid var(--gold); text-align:center;" placeholder="ì±”í”¼ì–¸"><button class="btn-toggle ing" onclick="toggleResult(this)">ğŸ•’ ì§„í–‰</button></div>`;
    card.innerHTML = `<div style="display:flex; gap:10px; margin-bottom:10px;"><input class="nick-disp" placeholder="ë°©ì†¡ ë‹‰ë„¤ì„" style="flex:1; padding:8px;"><input class="nick-riot" placeholder="ë¡¤ ë‹‰ë„¤ì„" style="flex:1; padding:8px;"></div><div class="history-editor">${hHTML}</div>`;
    card.dataset.team = team;
    return card;
}

function rebuild() {
    const rW = document.getElementById('redPlayers'); const bW = document.getElementById('bluePlayers');
    const c = document.getElementById('teamCount').value;
    rW.innerHTML = ''; bW.innerHTML = '';
    for(let i=0; i<c; i++) { rW.appendChild(createMemberCard('red')); bW.appendChild(createMemberCard('blue')); }
}

async function applyToSupabase() {
    const players = [];
    document.querySelectorAll('.member-card').forEach(card => {
        const name = card.querySelector('.nick-disp').value.trim();
        if(!name) return;
        const recent = [], champs = [];
        card.querySelectorAll('.history-item').forEach(item => {
            const txt = item.querySelector('.btn-toggle').innerText;
            recent.push(txt.includes('ìŠ¹ë¦¬') ? 'win' : txt.includes('íŒ¨ë°°') ? 'lose' : 'ing');
            champs.push(item.querySelector('.champ-input').value.trim() || 'None');
        });
        players.push({ name, team: card.dataset.team, riot_id: card.querySelector('.nick-riot').value.trim(), wins: recent.filter(r=>r==='win').length, losses: recent.filter(r=>r==='lose').length, recent, champions: champs });
    });
    try {
        const totalSec = (Number(timerMin.value) * 60) + Number(timerSec.value);
        await sb.from('settings').upsert({ id: 1, red_team_name: redNameInput.value, blue_team_name: blueNameInput.value, member_count: Number(teamCount.value), updated_at: new Date() });
        // íƒ€ì´ë¨¸ë¥¼ ìœ„í•´ ë³„ë„ì˜ ë©”íƒ€ë°ì´í„°ë‚˜ íŠ¹ì • í•„ë“œë¥¼ í™œìš© (ì—¬ê¸°ì„œëŠ” ê°„ë‹¨íˆ local ì „ì—­ ë³€ìˆ˜ë¡œ ê´€ë¦¬ë˜ì§€ë§Œ DBì— ì €ì¥ ì¶”ì²œ)
        localStorage.setItem('targetTime', totalSec); 
        await sb.from('players').delete().neq('name', '_dummy_');
        if(players.length > 0) await sb.from('players').insert(players);
        alert('âœ… ë°˜ì˜ ì™„ë£Œ!');
    } catch(e) { alert(e.message); }
}
rebuild();
</script>
</body>
</html>























