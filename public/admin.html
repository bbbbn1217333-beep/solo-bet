<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8" />
  <title>ì†”ë­ ë‚´ê¸° ê´€ë¦¬ì íŒ¨ë„</title>

  <!-- Supabase -->
  <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>

  <style>
    body {
      background: #0e0e0e;
      color: #fff;
      font-family: Arial, sans-serif;
      padding: 20px;
    }

    h1 {
      text-align: center;
      color: #ff3b3b;
      margin-bottom: 20px;
    }

    .wrap {
      max-width: 1000px;
      margin: auto;
      border: 1px solid #333;
      padding: 20px;
      border-radius: 10px;
    }

    .top {
      display: flex;
      gap: 10px;
      margin-bottom: 20px;
    }

    .top input {
      flex: 1;
      padding: 8px;
      background: #111;
      border: 1px solid #444;
      color: #fff;
      border-radius: 6px;
    }

    .teams {
      display: grid;
      grid-template-columns: 1fr 1fr;
      gap: 20px;
    }

    .team {
      border: 1px solid #444;
      padding: 15px;
      border-radius: 8px;
    }

    .team h2 {
      text-align: center;
      margin-bottom: 10px;
    }

    .players {
      display: grid;
      grid-template-columns: repeat(auto-fill, minmax(120px, 1fr));
      gap: 8px;
    }

    .players input {
      padding: 6px;
      background: #111;
      border: 1px solid #444;
      color: #fff;
      border-radius: 6px;
    }

    .actions {
      margin-top: 20px;
      text-align: center;
    }

    button {
      padding: 12px 30px;
      background: #ff3b3b;
      border: none;
      color: #fff;
      font-size: 16px;
      border-radius: 6px;
      cursor: pointer;
    }
  </style>
</head>

<body>
  <h1>ì†”ë­ ë‚´ê¸° ê´€ë¦¬ì íŒ¨ë„</h1>

  <div class="wrap">
    <div class="top">
      <input id="redTeamName" placeholder="ìš°ë¦¬íŒ€ ì´ë¦„" />
      <input id="blueTeamName" placeholder="ìƒëŒ€íŒ€ ì´ë¦„" />
      <input id="teamCount" type="number" min="1" max="33" value="5" />
    </div>

    <div class="teams">
      <div class="team">
        <h2>ìš°ë¦¬íŒ€</h2>
        <div class="players" id="redPlayers"></div>
      </div>

      <div class="team">
        <h2>ìƒëŒ€íŒ€</h2>
        <div class="players" id="bluePlayers"></div>
      </div>
    </div>

    <div class="actions">
      <button onclick="apply()">ì ìš©</button>
    </div>
  </div>

<script>
  // ğŸ”‘ ì—¬ê¸°ì— ë³¸ì¸ í‚¤ ì…ë ¥
  const SUPABASE_URL = "https://hsvknfmnsehwytnvaiwr.supabase.co";
  const SUPABASE_KEY = "sb_publishable_l2wj1IeGSfcxgKVjJ28n0w_WK9iHm-j";

  const supabase = window.supabase.createClient(
    SUPABASE_URL,
    SUPABASE_KEY
  );

  const redWrap = document.getElementById("redPlayers");
  const blueWrap = document.getElementById("bluePlayers");
  const teamCountInput = document.getElementById("teamCount");

  function createInputs() {
    const count = Number(teamCountInput.value);

    redWrap.innerHTML = "";
    blueWrap.innerHTML = "";

    for (let i = 0; i < count; i++) {
      const r = document.createElement("input");
      r.placeholder = `ìš°ë¦¬íŒ€ ${i + 1}`;
      redWrap.appendChild(r);

      const b = document.createElement("input");
      b.placeholder = `ìƒëŒ€íŒ€ ${i + 1}`;
      blueWrap.appendChild(b);
    }
  }

  teamCountInput.addEventListener("change", createInputs);
  createInputs();

  async function apply() {
    const redNames = [...redWrap.querySelectorAll("input")]
      .map(i => i.value.trim())
      .filter(v => v);

    const blueNames = [...blueWrap.querySelectorAll("input")]
      .map(i => i.value.trim())
      .filter(v => v);

    if (redNames.length === 0 || blueNames.length === 0) {
      alert("í”Œë ˆì´ì–´ ì´ë¦„ì„ ì…ë ¥í•´ì£¼ì„¸ìš”.");
      return;
    }

    // ê¸°ì¡´ ë°ì´í„° ì‚­ì œ
    await supabase.from("players").delete().neq("id", 0);

    // ìƒˆ ë°ì´í„° ì‚½ì…
    const players = [
      ...redNames.map(name => ({
        name,
        team: "red",
        wins: 0,
        losses: 0,
        streak: 0
      })),
      ...blueNames.map(name => ({
        name,
        team: "blue",
        wins: 0,
        losses: 0,
        streak: 0
      }))
    ];

    const { error } = await supabase.from("players").insert(players);

    if (error) {
      alert("ì €ì¥ ì‹¤íŒ¨");
      console.error(error);
    } else {
      alert("ì ìš© ì™„ë£Œ");
    }
  }
</script>
</body>
</html>














